# inventory_aoscx.yaml
plugin: netbox.netbox.nb_inventory
api_endpoint: "https://netbox.timberlinkaustralia.com.au"
token: "{{ lookup('env', 'NETBOX_TOKEN') }}"
validate_certs: false
config_context: true
compose:
  ansible_network_os: platform.slug
  ansible_host: primary_ip.address.split('/')[0]
group_by:
  - sites
  - platform
keyed_groups:
  - key: device_role.slug
    prefix: "role"
  - key: platform.slug
    prefix: "platform"
query_filters:
  - platform__n: ["aoscx", "aoscx_l2"]
  - status: "active"
  - has_primary_ip: "true"